# Excel 批量导入卡密 - 使用指南

## 📍 功能入口

### 方法 1：通过卡密列表页面
1. 访问后台：https://myshop.fyyd.net/admin/
2. 登录管理员账号
3. 点击左侧菜单 **"卡密"**
4. 在卡密列表页面，**右上角**会看到两个按钮：
   ```
   [ + 添加卡密 ]  [ Excel 批量导入 ]
   ```
5. 点击 **"Excel 批量导入"** 按钮

### 方法 2：直接访问链接
直接访问：https://myshop.fyyd.net/admin/shop/card/import-excel/

---

## 📊 Excel 文件格式要求

### 文件格式
- **仅支持** `.xlsx` 格式（Excel 2007 及以上版本）
- **不支持** `.xls`（旧版 Excel）或 `.csv` 格式

### 数据格式
```
| 卡密内容              |
|----------------------|
| ABCD-1234-EFGH-5678  |  ← 第 2 行开始才是数据
| IJKL-9012-MNOP-3456  |
| QRST-7890-UVWX-1234  |
| ...                  |
```

**重要说明：**
- **第一行**：表头（会被自动跳过）
- **从第二行开始**：每行第一列（A列）为一个卡密
- **空行**：会自动跳过
- **其他列**：会被忽略（只读取第一列）

---

## 🎯 导入步骤

### Step 1: 准备 Excel 文件
创建一个 .xlsx 文件，按照上述格式填入卡密内容

### Step 2: 访问导入页面
点击"Excel 批量导入"按钮，进入导入页面

### Step 3: 填写导入信息
- **选择商品**：从下拉菜单选择要添加卡密的商品
- **选择文件**：点击"浏览"，选择准备好的 Excel 文件

### Step 4: 开始导入
点击 **"开始导入"** 按钮

### Step 5: 查看结果
- ✅ 成功：显示 "成功导入 X 个卡密到商品「XXX」"
- ⚠️ 警告：如果文件为空或格式错误，会显示相应提示
- ❌ 失败：会显示具体错误信息

---

## ✅ 示例数据

### 示例 1：激活码格式
```
卡密内容
ABCD-1234-EFGH-5678
IJKL-9012-MNOP-3456
QRST-7890-UVWX-1234
```

### 示例 2：下载链接格式
```
卡密内容
https://example.com/download/code1
https://example.com/download/code2
https://example.com/download/code3
```

### 示例 3：账号密码格式
```
卡密内容
账号：user001 密码：pass123456
账号：user002 密码：pass789012
账号：user003 密码：pass345678
```

---

## ⚠️ 注意事项

1. **唯一性**：请确保每个卡密唯一，避免重复导入
2. **格式清理**：卡密内容会自动去除前后空格
3. **不可撤销**：导入操作不可撤销，请谨慎操作
4. **文件大小**：建议单次导入不超过 1000 条，避免超时
5. **商品关联**：必须先创建商品，才能导入该商品的卡密

---

## 🔧 常见问题

**Q1: 为什么看不到"Excel 批量导入"按钮？**
- 确认已成功部署最新代码
- 尝试清除浏览器缓存并刷新页面
- 检查是否有管理员权限

**Q2: 导入失败提示"只支持 .xlsx 格式"？**
- 确保使用 Excel 2007 以上版本保存为 .xlsx
- 不要使用 .xls 或 .csv 格式

**Q3: 导入成功但数量不对？**
- 检查是否有空行（空行会被跳过）
- 检查第一行是否为表头（表头会被跳过）
- 确认数据在第一列（其他列会被忽略）

**Q4: 可以导入其他格式的数据吗？**
- 卡密内容支持任意文本格式
- 可以是激活码、下载链接、账号密码等
- 每个卡密可以包含多行信息

---

## 📝 推荐工作流程

1. **创建商品**：在后台先创建需要的商品（如：ChatGPT Plus 账号）
2. **准备卡密**：在 Excel 中整理好所有卡密信息
3. **批量导入**：使用 Excel 导入功能一次性添加所有卡密
4. **验证库存**：在商品列表查看库存数量是否正确
5. **测试购买**：在前台测试购买流程是否正常

---

## 💡 效率提升技巧

- 使用 Excel 公式批量生成测试数据
- 从供应商处直接获取 Excel 格式的卡密列表
- 定期备份卡密数据到 Excel，方便管理
- 使用筛选功能只导入未售出的卡密

---

**如有问题，请联系技术支持！**
